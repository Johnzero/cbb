<!-- Javascript -->
<script src="__ROOT__/statics/js/angular/angular.js"></script>
<script src="__ROOT__/statics/js/angular/angular-animate.js"></script>
<script src="__ROOT__/statics/js/angular/angular-ui-router.js"></script>
<script src="__ROOT__/statics/js/angular/loading-bar.js"></script>
<link href='__ROOT__/statics/js/angular/loading-bar.css' rel='stylesheet' />

<script type="text/javascript">
	var cultural = angular.module('cultural', ['ui.router','angular-loading-bar','ngAnimate']);
	cultural.config(function(cfpLoadingBarProvider,$stateProvider, $urlRouterProvider,$locationProvider,$httpProvider) {

		$urlRouterProvider.when("", "/")
		.otherwise(function($injector, $location){
			$injector.invoke(['$state', function($state) {
    			window.location = $location['$$absUrl'];
  			}]);
  		});

		$stateProvider
		.state("/", {
			url: "/",
			templateUrl: "/"
		})
		.state("user", {
			url: "/user/:actionName/:tplName.html",
			templateUrl: function ($stateParams){
			    return '/user/' + $stateParams.actionName + '/' + $stateParams.tplName + '.html';
			}
		})
		.state("list", {
			url: "/list/index/id/:listId.html",
			templateUrl: function ($stateParams){
			    return '/list/index/id/' + $stateParams.listId + '.html';
			}
		})

		cfpLoadingBarProvider.includeSpinner = true;
		$locationProvider.html5Mode(true);
		$httpProvider.defaults.headers.common['X-Requested-With'] = 'application/angularjs';
		
	});

	cultural.run(function($rootScope){
	    $rootScope
	        .$on('$stateChangeStart', 
	            function(event, toState, toParams, fromState, fromParams){ 
	                $("#layout").html("<div class='tf-spin' ng-show='loading'><i class='fa fa-spinner fa-3x fa-spin'></i><p>数据加载中</p></div>");
	        });
	    $rootScope
	        .$on('$stateChangeSuccess',
	            function(event, toState, toParams, fromState, fromParams){ 
	                $("#layout").remove(".tf-spin");
	        });

	});
</script>
<script type="text/javascript">
$(function(){
	$('body').on('touchstart.dropdown', '.dropdown-menu', function (e) { e.stopPropagation(); });
	
	;(function($){
		$.fn.totop=function(opt){
			var scrolling=false;
			return this.each(function(){
				var $this=$(this);
				$(window).scroll(function(){
					if(!scrolling){
						var sd=$(window).scrollTop();
						if(sd>100){
							$this.fadeIn();
						}else{
							$this.fadeOut();
						}
					}
				});
				
				$this.click(function(){
					scrolling=true;
					$('html, body').animate({
						scrollTop : 0
					}, 500,function(){
						scrolling=false;
						$this.fadeOut();
					});
				});
			});
		};
	})(jQuery);
	
	$("#backtotop").totop();
	
});
</script>
